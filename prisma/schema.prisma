generator client {
  provider               = "prisma-client"
  output                 = "./generated/prisma"
  generatedFileExtension = "ts"
  importFileExtension    = "ts"
}

datasource db {
  provider = "postgresql"
}

model User {
  id          String       @id @default(cuid())
  clerkUserId String       @unique
  email       String       @unique
  name        String?
  imageUrl    String?
  createdAt   DateTime     @default(now()) @map("created_at")
  updatedAt   DateTime     @updatedAt @map("updated_at")
  documents   Document[]
  investments Investment[]
}

model Document {
  id         String   @id @default(cuid())
  userId     String
  blobUrl    String   @unique
  filename   String
  fileType   String
  fileSize   Int
  uploadedAt DateTime @default(now())
  user       User     @relation(fields: [userId], references: [clerkUserId], onDelete: Cascade)

  @@index([userId])
}

model Investment {
  id               String           @id @default(cuid())
  organisationName String
  relatedData      String?
  investmentType   String
  currency         String
  investmentAmount Float
  interestRate     Float
  incomeTax        Float
  expirationDate   DateTime
  expirationStatus ExpirationStatus
  userId           String
  createdAt        DateTime         @default(now()) @map("created_at")
  updatedAt        DateTime         @updatedAt @map("updated_at")
  user             User             @relation(fields: [userId], references: [clerkUserId], onDelete: Cascade)

  @@index([userId])
  @@index([expirationDate])
}

model BnmBaseRate {
  id        String   @id @default(cuid())
  rate      Float
  createdAt DateTime @default(now()) @map("created_at")
}

model MarketIndicator {
  id        String                @id @default(cuid())
  name      MarketIndicatorName
  value     Float
  date      DateTime
  updatedAt DateTime              @updatedAt @map("updated_at")

  @@unique([name, date])
}

enum MarketIndicatorName {
  BASE_RATE
  INFLATION
}

enum ExpirationStatus {
  EXPIRING_LESS_THAN_3_MONTHS
  EXPIRING_IN_A_MONTH
  EXPIRED
  ACTIVE
}

enum InvestmentType {
  deposit
  bankDeposit
  governmentBond
  corporateBond
  eVMS
}
